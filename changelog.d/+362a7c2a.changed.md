Abstracting bucket client and bucket name from storage functions and improving tests
